const IMAGE_W = 4,IMAGE_H = 4;
const Map = require('ti.map');
var openGallery = require('./gallery').createWindow;

function createWindow(intervista) {
  var win = Ti.UI.createWindow({
    title: intervista.titolo });

  win.on('open', function () {
    var actionbar = win.activity.actionBar;
    actionbar.displayHomeAsUp = true;
    actionbar.onHomeIconItemSelected = function () {
      win.close();
    };
  });

  var scrollView = Ti.UI.createScrollView();
  win.add(scrollView);

  var listView = Ti.UI.createView({
    layout: 'vertical',
    height: Ti.UI.SIZE,
    top: 0 });

  scrollView.add(listView);

  var cover = Ti.UI.createView({ height: Ti.UI.SIZE });
  listView.add(cover);
  cover.add(Ti.UI.createImageView({
    width: '100%',
    height: Ti.UI.SIZE,
    image: intervista.immagineCover }));

  cover.add(Ti.UI.createImageView({
    width: 50,
    height: Ti.UI.SIZE,
    image: 'assets/images/youtube.png' }));

  cover.on('click', () => Ti.Platform.openURL(intervista.linkVideo));

  listView.add(Ti.UI.createLabel({
    color: 'black',
    width: Ti.UI.FILL,
    height: Ti.UI.SIZE,
    textAlign: Ti.UI.TEXT_ALIGNMENT_CENTER,
    left: 16, right: 16, top: 16, bottom: 4,
    text: intervista.intervistato,
    font: {
      fontSize: 20,
      fontWeight: 'bold' } }));


  var image = Ti.UI.createView({
    width: 128,
    height: 128,
    borderRadius: 64,
    top: 4, bottom: 4 });

  listView.add(image);
  image.add(Ti.UI.createView({
    width: 128 / IMAGE_H * IMAGE_W,
    height: 128,
    backgroundImage: intervista.immagineProfilo }));


  listView.add(Ti.UI.createLabel({
    color: 'black',
    width: Ti.UI.FILL,
    height: Ti.UI.SIZE,
    left: 16, right: 16, top: 16, bottom: 4,
    text: intervista.dove,
    font: {
      fontWeight: 'italic' } }));


  listView.add(Ti.UI.createLabel({
    color: 'black',
    width: Ti.UI.FILL,
    height: Ti.UI.SIZE,
    left: 16, right: 16, top: 4, bottom: 8,
    text: intervista.abstract,
    font: {
      fontWeight: 'bold' } }));


  listView.add(Ti.UI.createLabel({
    color: 'black',
    width: Ti.UI.FILL,
    height: Ti.UI.SIZE,
    left: 16, right: 16, bottom: 16,
    text: intervista.body,
    font: {
      fontSize: 16 } }));



  if (intervista.link) {
    var linkView = Ti.UI.createLabel({
      color: '#4286f4',
      width: Ti.UI.FILL,
      height: Ti.UI.SIZE,
      left: 16, right: 16, top: 0, bottom: 8,
      text: intervista.link.label,
      textAlign: Ti.UI.TEXT_ALIGNMENT_RIGHT,
      font: {
        fontSize: 16 } });


    linkView.on('click', function () {
      Ti.Platform.openURL(intervista.link.url);
    });
    listView.add(linkView);
  }

  listView.add(Ti.UI.createLabel({
    color: 'black',
    width: Ti.UI.FILL,
    height: Ti.UI.SIZE,
    left: 16, right: 16, top: 8, bottom: 4,
    text: 'Galleria delle foto',
    font: {
      fontSize: 20,
      fontWeight: 'bold' } }));


  listView.add(createGallery(intervista.foto));

  listView.add(Ti.UI.createLabel({
    color: 'black',
    width: Ti.UI.FILL,
    height: Ti.UI.SIZE,
    left: 16, right: 16, top: 8, bottom: 4,
    text: 'Dove',
    font: {
      fontSize: 20,
      fontWeight: 'bold' } }));


  listView.add(Ti.UI.createLabel({
    color: 'black',
    width: Ti.UI.FILL,
    height: Ti.UI.SIZE,
    left: 16, right: 16, top: 0, bottom: 4,
    text: intervista.indirizzo,
    font: {
      fontSize: 16 } }));


  listView.add(Map.createView({
    height: 150,
    mapType: Map.SATELLITE_TYPE,
    region: {
      latitude: intervista.coordinate[0],
      longitude: intervista.coordinate[1],
      latitudeDelta: 0.005,
      longitudeDelta: 0.005 },

    animate: true,
    regionFit: true,
    userLocation: false,
    bottom: 16,
    annotations: [Map.createAnnotation({
      latitude: intervista.coordinate[0],
      longitude: intervista.coordinate[1],
      pincolor: Map.ANNOTATION_RED })] }));



  win.open();
}

function createGallery(photos) {
  const scroll = Ti.UI.createScrollView({
    height: Ti.UI.SIZE,
    width: Ti.UI.FILL,
    backgroundColor: '#121212',
    layout: 'horizontal',
    contentWidth: Ti.UI.SIZE,
    horizontalWrap: false,
    scrollType: 'horizontal',
    bottom: 16 });


  for (var i = 0; i < photos.length; i++) {
    const index = i;
    const imageView = Ti.UI.createImageView({
      height: 150,
      width: 200,
      image: photos[i],
      borderRadius: 8,
      left: i === 0 ? 16 : 4,
      right: i === photos.length - 1 ? 16 : 4,
      top: 8, bottom: 8 });

    imageView.on('click', function () {
      openGallery(photos, index);
    });
    scroll.add(imageView);
  }
  return scroll;
}

exports.createWindow = createWindow;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImludGVydmlzdGEuanMiXSwibmFtZXMiOlsiSU1BR0VfVyIsIklNQUdFX0giLCJNYXAiLCJyZXF1aXJlIiwib3BlbkdhbGxlcnkiLCJjcmVhdGVXaW5kb3ciLCJpbnRlcnZpc3RhIiwid2luIiwiVGkiLCJVSSIsInRpdGxlIiwidGl0b2xvIiwib24iLCJhY3Rpb25iYXIiLCJhY3Rpdml0eSIsImFjdGlvbkJhciIsImRpc3BsYXlIb21lQXNVcCIsIm9uSG9tZUljb25JdGVtU2VsZWN0ZWQiLCJjbG9zZSIsInNjcm9sbFZpZXciLCJjcmVhdGVTY3JvbGxWaWV3IiwiYWRkIiwibGlzdFZpZXciLCJjcmVhdGVWaWV3IiwibGF5b3V0IiwiaGVpZ2h0IiwiU0laRSIsInRvcCIsImNvdmVyIiwiY3JlYXRlSW1hZ2VWaWV3Iiwid2lkdGgiLCJpbWFnZSIsImltbWFnaW5lQ292ZXIiLCJQbGF0Zm9ybSIsIm9wZW5VUkwiLCJsaW5rVmlkZW8iLCJjcmVhdGVMYWJlbCIsImNvbG9yIiwiRklMTCIsInRleHRBbGlnbiIsIlRFWFRfQUxJR05NRU5UX0NFTlRFUiIsImxlZnQiLCJyaWdodCIsImJvdHRvbSIsInRleHQiLCJpbnRlcnZpc3RhdG8iLCJmb250IiwiZm9udFNpemUiLCJmb250V2VpZ2h0IiwiYm9yZGVyUmFkaXVzIiwiYmFja2dyb3VuZEltYWdlIiwiaW1tYWdpbmVQcm9maWxvIiwiZG92ZSIsImFic3RyYWN0IiwiYm9keSIsImxpbmsiLCJsaW5rVmlldyIsImxhYmVsIiwiVEVYVF9BTElHTk1FTlRfUklHSFQiLCJ1cmwiLCJjcmVhdGVHYWxsZXJ5IiwiZm90byIsImluZGlyaXp6byIsIm1hcFR5cGUiLCJTQVRFTExJVEVfVFlQRSIsInJlZ2lvbiIsImxhdGl0dWRlIiwiY29vcmRpbmF0ZSIsImxvbmdpdHVkZSIsImxhdGl0dWRlRGVsdGEiLCJsb25naXR1ZGVEZWx0YSIsImFuaW1hdGUiLCJyZWdpb25GaXQiLCJ1c2VyTG9jYXRpb24iLCJhbm5vdGF0aW9ucyIsImNyZWF0ZUFubm90YXRpb24iLCJwaW5jb2xvciIsIkFOTk9UQVRJT05fUkVEIiwib3BlbiIsInBob3RvcyIsInNjcm9sbCIsImJhY2tncm91bmRDb2xvciIsImNvbnRlbnRXaWR0aCIsImhvcml6b250YWxXcmFwIiwic2Nyb2xsVHlwZSIsImkiLCJsZW5ndGgiLCJpbmRleCIsImltYWdlVmlldyIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLE9BQU8sR0FBRyxDQUFoQixDQUFtQkMsT0FBTyxHQUFHLENBQTdCO0FBQ0EsTUFBTUMsR0FBRyxHQUFHQyxPQUFPLENBQUMsUUFBRCxDQUFuQjtBQUNBLElBQUlDLFdBQVcsR0FBR0QsT0FBTyxDQUFDLFdBQUQsQ0FBUCxDQUFxQkUsWUFBdkM7O0FBRUEsU0FBU0EsWUFBVCxDQUF1QkMsVUFBdkIsRUFBbUM7QUFDakMsTUFBSUMsR0FBRyxHQUFHQyxFQUFFLENBQUNDLEVBQUgsQ0FBTUosWUFBTixDQUFtQjtBQUMzQkssSUFBQUEsS0FBSyxFQUFFSixVQUFVLENBQUNLLE1BRFMsRUFBbkIsQ0FBVjs7QUFHQUosRUFBQUEsR0FBRyxDQUFDSyxFQUFKLENBQU8sTUFBUCxFQUFlLFlBQVk7QUFDekIsUUFBSUMsU0FBUyxHQUFHTixHQUFHLENBQUNPLFFBQUosQ0FBYUMsU0FBN0I7QUFDQUYsSUFBQUEsU0FBUyxDQUFDRyxlQUFWLEdBQTRCLElBQTVCO0FBQ0FILElBQUFBLFNBQVMsQ0FBQ0ksc0JBQVYsR0FBbUMsWUFBVztBQUM1Q1YsTUFBQUEsR0FBRyxDQUFDVyxLQUFKO0FBQ0QsS0FGRDtBQUdELEdBTkQ7O0FBUUEsTUFBSUMsVUFBVSxHQUFHWCxFQUFFLENBQUNDLEVBQUgsQ0FBTVcsZ0JBQU4sRUFBakI7QUFDQWIsRUFBQUEsR0FBRyxDQUFDYyxHQUFKLENBQVFGLFVBQVI7O0FBRUEsTUFBSUcsUUFBUSxHQUFHZCxFQUFFLENBQUNDLEVBQUgsQ0FBTWMsVUFBTixDQUFpQjtBQUM1QkMsSUFBQUEsTUFBTSxFQUFFLFVBRG9CO0FBRTVCQyxJ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RSxHQUQ4QjtBQUV0Q0ssTUFBQUEsS0FBSyxFQUFFLEdBRitCO0FBR3RDQyxNQUFBQSxLQUFLLEVBQUVnRCxNQUFNLENBQUNNLENBQUQsQ0FIeUI7QUFJdENwQyxNQUFBQSxZQUFZLEVBQUUsQ0FKd0I7QUFLdENSLE1BQUFBLElBQUksRUFBRTRDLENBQUMsS0FBSyxDQUFOLEdBQVUsRUFBVixHQUFlLENBTGlCO0FBTXRDM0MsTUFBQUEsS0FBSyxFQUFFMkMsQ0FBQyxLQUFLTixNQUFNLENBQUNPLE1BQVAsR0FBYyxDQUFwQixHQUF3QixFQUF4QixHQUE2QixDQU5FO0FBT3RDM0QsTUFBQUEsR0FBRyxFQUFFLENBUGlDLEVBTzlCZ0IsTUFBTSxFQUFFLENBUHNCLEVBQXRCLENBQWxCOztBQVNBNkMsSUFBQUEsU0FBUyxDQUFDNUUsRUFBVixDQUFhLE9BQWIsRUFBc0IsWUFBWTtBQUNoQ1IsTUFBQUEsV0FBVyxDQUFDMkUsTUFBRCxFQUFTUSxLQUFULENBQVg7QUFDRCxLQUZEO0FBR0FQLElBQUFBLE1BQU0sQ0FBQzNELEdBQVAsQ0FBV21FLFNBQVg7QUFDRDtBQUNELFNBQU9SLE1BQVA7QUFDRDs7QUFFRFMsT0FBTyxDQUFDcEYsWUFBUixHQUF1QkEsWUFBdkIiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBJTUFHRV9XID0gNCwgSU1BR0VfSCA9IDQ7XG5jb25zdCBNYXAgPSByZXF1aXJlKCd0aS5tYXAnKTtcbnZhciBvcGVuR2FsbGVyeSA9IHJlcXVpcmUoJy4vZ2FsbGVyeScpLmNyZWF0ZVdpbmRvdztcblxuZnVuY3Rpb24gY3JlYXRlV2luZG93IChpbnRlcnZpc3RhKSB7XG4gIHZhciB3aW4gPSBUaS5VSS5jcmVhdGVXaW5kb3coe1xuICAgIHRpdGxlOiBpbnRlcnZpc3RhLnRpdG9sb1xuICB9KTtcbiAgd2luLm9uKCdvcGVuJywgZnVuY3Rpb24gKCkge1xuICAgIHZhciBhY3Rpb25iYXIgPSB3aW4uYWN0aXZpdHkuYWN0aW9uQmFyO1xuICAgIGFjdGlvbmJhci5kaXNwbGF5SG9tZUFzVXAgPSB0cnVlO1xuICAgIGFjdGlvbmJhci5vbkhvbWVJY29uSXRlbVNlbGVjdGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICB3aW4uY2xvc2UoKTtcbiAgICB9O1xuICB9KTtcblxuICB2YXIgc2Nyb2xsVmlldyA9IFRpLlVJLmNyZWF0ZVNjcm9sbFZpZXcoKTtcbiAgd2luLmFkZChzY3JvbGxWaWV3KTtcblxuICB2YXIgbGlzdFZpZXcgPSBUaS5VSS5jcmVhdGVWaWV3KHtcbiAgICAgIGxheW91dDogJ3ZlcnRpY2FsJyxcbiAgICAgIGhlaWdodDogVGkuVUkuU0laRSxcbiAgICAgIHRvcDogMCxcbiAgfSlcbiAgc2Nyb2xsVmlldy5hZGQobGlzdFZpZXcpO1xuXG4gIHZhciBjb3ZlciA9IFRpLlVJLmNyZWF0ZVZpZXcoeyBoZWlnaHQ6IFRpLlVJLlNJWkUgfSk7XG4gIGxpc3RWaWV3LmFkZChjb3Zlcik7XG4gIGNvdmVyLmFkZChUaS5VSS5jcmVhdGVJbWFnZVZpZXcoe1xuICAgIHdpZHRoOiAnMTAwJScsXG4gICAgaGVpZ2h0OiBUaS5VSS5TSVpFLFxuICAgIGltYWdlOiBpbnRlcnZpc3RhLmltbWFnaW5lQ292ZXJcbiAgfSkpXG4gIGNvdmVyLmFkZChUaS5VSS5jcmVhdGVJbWFnZVZpZXcoe1xuICAgIHdpZHRoOiA1MCxcbiAgICBoZWlnaHQ6IFRpLlVJLlNJWkUsXG4gICAgaW1hZ2U6ICdhc3NldHMvaW1hZ2VzL3lvdXR1YmUucG5nJ1xuICB9KSk7XG4gIGNvdmVyLm9uKCdjbGljaycsICgpID0+IFRpLlBsYXRmb3JtLm9wZW5VUkwoaW50ZXJ2aXN0YS5saW5rVmlkZW8pKVxuXG4gIGxpc3RWaWV3LmFkZChUaS5VSS5jcmVhdGVMYWJlbCh7XG4gICAgY29sb3I6ICdibGFjaycsXG4gICAgd2lkdGg6IFRpLlVJLkZJTEwsXG4gICAgaGVpZ2h0OiBUaS5VSS5TSVpFLFxuICAgIHRleHRBbGlnbjogVGkuVUkuVEVYVF9BTElHTk1FTlRfQ0VOVEVSLFxuICAgIGxlZnQ6IDE2LCByaWdodDogMTYsIHRvcDogMTYsIGJvdHRvbTogNCxcbiAgICB0ZXh0OiBpbnRlcnZpc3RhLmludGVydmlzdGF0byxcbiAgICBmb250OiB7XG4gICAgICBmb250U2l6ZTogMjAsXG4gICAgICBmb250V2VpZ2h0OiAnYm9sZCdcbiAgICB9XG4gIH0pKVxuICB2YXIgaW1hZ2UgPSBUaS5VSS5jcmVhdGVWaWV3KHtcbiAgICB3aWR0aDogMTI4LFxuICAgIGhlaWdodDogMTI4LFxuICAgIGJvcmRlclJhZGl1czogNjQsXG4gICAgdG9wOiA0LCBib3R0b206IDRcbiAgfSk7XG4gIGxpc3RWaWV3LmFkZChpbWFnZSk7XG4gIGltYWdlLmFkZChUaS5VSS5jcmVhdGVWaWV3KHtcbiAgICAgIHdpZHRoOiAxMjgvSU1BR0VfSCpJTUFHRV9XLFxuICAgICAgaGVpZ2h0OiAxMjgsXG4gICAgICBiYWNrZ3JvdW5kSW1hZ2U6IGludGVydmlzdGEuaW1tYWdpbmVQcm9maWxvLFxuICB9KSk7XG5cbiAgbGlzdFZpZXcuYWRkKFRpLlVJLmNyZWF0ZUxhYmVsKHtcbiAgICBjb2xvcjogJ2JsYWNrJyxcbiAgICB3aWR0aDogVGkuVUkuRklMTCxcbiAgICBoZWlnaHQ6IFRpLlVJLlNJWkUsXG4gICAgbGVmdDogMTYsIHJpZ2h0OiAxNiwgdG9wOiAxNiwgYm90dG9tOiA0LFxuICAgIHRleHQ6IGludGVydmlzdGEuZG92ZSxcbiAgICBmb250OiB7XG4gICAgICBmb250V2VpZ2h0OiAnaXRhbGljJ1xuICAgIH1cbiAgfSkpXG4gIGxpc3RWaWV3LmFkZChUaS5VSS5jcmVhdGVMYWJlbCh7XG4gICAgY29sb3I6ICdibGFjaycsXG4gICAgd2lkdGg6IFRpLlVJLkZJTEwsXG4gICAgaGVpZ2h0OiBUaS5VSS5TSVpFLFxuICAgIGxlZnQ6IDE2LCByaWdodDogMTYsIHRvcDogNCwgYm90dG9tOiA4LFxuICAgIHRleHQ6IGludGVydmlzdGEuYWJzdHJhY3QsXG4gICAgZm9udDoge1xuICAgICAgZm9udFdlaWdodDogJ2JvbGQnXG4gICAgfVxuICB9KSlcbiAgbGlzdFZpZXcuYWRkKFRpLlVJLmNyZWF0ZUxhYmVsKHtcbiAgICBjb2xvcjogJ2JsYWNrJyxcbiAgICB3aWR0aDogVGkuVUkuRklMTCxcbiAgICBoZWlnaHQ6IFRpLlVJLlNJWkUsXG4gICAgbGVmdDogMTYsIHJpZ2h0OiAxNiwgYm90dG9tOiAxNixcbiAgICB0ZXh0OiBpbnRlcnZpc3RhLmJvZHksXG4gICAgZm9udDoge1xuICAgICAgZm9udFNpemU6IDE2LFxuICAgIH1cblxuICB9KSlcbiAgaWYoaW50ZXJ2aXN0YS5saW5rKSB7XG4gICAgdmFyIGxpbmtWaWV3ID0gVGkuVUkuY3JlYXRlTGFiZWwoe1xuICAgICAgY29sb3I6ICcjNDI4NmY0JyxcbiAgICAgIHdpZHRoOiBUaS5VSS5GSUxMLFxuICAgICAgaGVpZ2h0OiBUaS5VSS5TSVpFLFxuICAgICAgbGVmdDogMTYsIHJpZ2h0OiAxNiwgdG9wOiAwLCBib3R0b206IDgsXG4gICAgICB0ZXh0OiBpbnRlcnZpc3RhLmxpbmsubGFiZWwsXG4gICAgICB0ZXh0QWxpZ246IFRpLlVJLlRFWFRfQUxJR05NRU5UX1JJR0hULFxuICAgICAgZm9udDoge1xuICAgICAgICBmb250U2l6ZTogMTYsXG4gICAgICB9XG4gICAgfSlcbiAgICBsaW5rVmlldy5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICBUaS5QbGF0Zm9ybS5vcGVuVVJMKGludGVydmlzdGEubGluay51cmwpO1xuICAgIH0pXG4gICAgbGlzdFZpZXcuYWRkKGxpbmtWaWV3KVxuICB9XG5cbiAgbGlzdFZpZXcuYWRkKFRpLlVJLmNyZWF0ZUxhYmVsKHtcbiAgICBjb2xvcjogJ2JsYWNrJyxcbiAgICB3aWR0aDogVGkuVUkuRklMTCxcbiAgICBoZWlnaHQ6IFRpLlVJLlNJWkUsXG4gICAgbGVmdDogMTYsIHJpZ2h0OiAxNiwgdG9wOiA4LCBib3R0b206IDQsXG4gICAgdGV4dDogJ0dhbGxlcmlhIGRlbGxlIGZvdG8nLFxuICAgIGZvbnQ6IHtcbiAgICAgIGZvbnRTaXplOiAyMCxcbiAgICAgIGZvbnRXZWlnaHQ6ICdib2xkJ1xuICAgIH1cbiAgfSkpXG4gIGxpc3RWaWV3LmFkZChjcmVhdGVHYWxsZXJ5KGludGVydmlzdGEuZm90bykpO1xuXG4gIGxpc3RWaWV3LmFkZChUaS5VSS5jcmVhdGVMYWJlbCh7XG4gICAgY29sb3I6ICdibGFjaycsXG4gICAgd2lkdGg6IFRpLlVJLkZJTEwsXG4gICAgaGVpZ2h0OiBUaS5VSS5TSVpFLFxuICAgIGxlZnQ6IDE2LCByaWdodDogMTYsIHRvcDogOCwgYm90dG9tOiA0LFxuICAgIHRleHQ6ICdEb3ZlJyxcbiAgICBmb250OiB7XG4gICAgICBmb250U2l6ZTogMjAsXG4gICAgICBmb250V2VpZ2h0OiAnYm9sZCdcbiAgICB9XG4gIH0pKVxuICBsaXN0Vmlldy5hZGQoVGkuVUkuY3JlYXRlTGFiZWwoe1xuICAgIGNvbG9yOiAnYmxhY2snLFxuICAgIHdpZHRoOiBUaS5VSS5GSUxMLFxuICAgIGhlaWdodDogVGkuVUkuU0laRSxcbiAgICBsZWZ0OiAxNiwgcmlnaHQ6IDE2LCB0b3A6IDAsIGJvdHRvbTogNCxcbiAgICB0ZXh0OiBpbnRlcnZpc3RhLmluZGlyaXp6byxcbiAgICBmb250OiB7XG4gICAgICBmb250U2l6ZTogMTYsXG4gICAgfVxuICB9KSlcbiAgbGlzdFZpZXcuYWRkKE1hcC5jcmVhdGVWaWV3KHtcbiAgICBoZWlnaHQ6IDE1MCxcbiAgICBtYXBUeXBlOiBNYXAuU0FURUxMSVRFX1RZUEUsXG4gICAgcmVnaW9uOiB7XG4gICAgICBsYXRpdHVkZTogaW50ZXJ2aXN0YS5jb29yZGluYXRlWzBdLFxuICAgICAgbG9uZ2l0dWRlOiBpbnRlcnZpc3RhLmNvb3JkaW5hdGVbMV0sXG4gICAgICBsYXRpdHVkZURlbHRhOiAwLjAwNSxcbiAgICAgIGxvbmdpdHVkZURlbHRhOiAwLjAwNVxuICAgIH0sXG4gICAgYW5pbWF0ZTogdHJ1ZSxcbiAgICByZWdpb25GaXQ6IHRydWUsXG4gICAgdXNlckxvY2F0aW9uOiBmYWxzZSxcbiAgICBib3R0b206IDE2LFxuICAgIGFubm90YXRpb25zOiBbTWFwLmNyZWF0ZUFubm90YXRpb24oe1xuICAgICAgbGF0aXR1ZGU6IGludGVydmlzdGEuY29vcmRpbmF0ZVswXSxcbiAgICAgIGxvbmdpdHVkZTogaW50ZXJ2aXN0YS5jb29yZGluYXRlWzFdLFxuICAgICAgcGluY29sb3I6IE1hcC5BTk5PVEFUSU9OX1JFRCxcbiAgICB9KV1cbiAgfSkpXG4gIFxuICB3aW4ub3BlbigpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVHYWxsZXJ5KHBob3Rvcykge1xuICBjb25zdCBzY3JvbGwgPSBUaS5VSS5jcmVhdGVTY3JvbGxWaWV3KHtcbiAgICBoZWlnaHQ6IFRpLlVJLlNJWkUsXG4gICAgd2lkdGg6IFRpLlVJLkZJTEwsXG4gICAgYmFja2dyb3VuZENvbG9yOiAnIzEyMTIxMicsXG4gICAgbGF5b3V0OiAnaG9yaXpvbnRhbCcsXG4gICAgY29udGVudFdpZHRoOiBUaS5VSS5TSVpFLFxuICAgIGhvcml6b250YWxXcmFwOiBmYWxzZSxcbiAgICBzY3JvbGxUeXBlOiAnaG9yaXpvbnRhbCcsXG4gICAgYm90dG9tOiAxNixcbiAgfSk7XG5cbiAgZm9yKHZhciBpID0gMDsgaTxwaG90b3MubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBpbmRleCA9IGk7XG4gICAgY29uc3QgaW1hZ2VWaWV3ID0gVGkuVUkuY3JlYXRlSW1hZ2VWaWV3KHtcbiAgICAgIGhlaWdodDogMTUwLFxuICAgICAgd2lkdGg6IDIwMCxcbiAgICAgIGltYWdlOiBwaG90b3NbaV0sXG4gICAgICBib3JkZXJSYWRpdXM6IDgsXG4gICAgICBsZWZ0OiBpID09PSAwID8gMTYgOiA0LFxuICAgICAgcmlnaHQ6IGkgPT09IHBob3Rvcy5sZW5ndGgtMSA/IDE2IDogNCxcbiAgICAgIHRvcDogOCwgYm90dG9tOiA4LFxuICAgIH0pXG4gICAgaW1hZ2VWaWV3Lm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgIG9wZW5HYWxsZXJ5KHBob3RvcywgaW5kZXgpO1xuICAgIH0pXG4gICAgc2Nyb2xsLmFkZChpbWFnZVZpZXcpXG4gIH1cbiAgcmV0dXJuIHNjcm9sbDtcbn1cblxuZXhwb3J0cy5jcmVhdGVXaW5kb3cgPSBjcmVhdGVXaW5kb3c7Il0sInNvdXJjZVJvb3QiOiIvVXNlcnMvbHVpZ2l2aXRlbGxpL3RpdGFuaXVtLXByb2ovcGlzdGNjaS1zaGFyaW5nLWV4cGVyaWVuY2UvUmVzb3VyY2VzIn0=
